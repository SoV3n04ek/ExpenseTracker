<div class="centered-container">
    <div class="card">
        <div class="text-center">
            <h2 class="mt-6">Create Account</h2>
            <p class="mt-2 text-muted">Join us to start tracking your expenses</p>
        </div>

        @if (store.error()) {
        <div class="error-alert">
            @if (isArray(store.error())) {
            <ul class="mb-0">
                @for (err of asArray(store.error()); track $index) {
                <li>{{ err }}</li>
                }
            </ul>
            } @else {
            <p>{{ store.error() }}</p>
            }
        </div>
        }

        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="mt-8">
            <div class="mb-4">
                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Full Name</mat-label>
                    <input matInput formControlName="name" placeholder="John Doe" maxlength="50">
                    @if (registerForm.controls.name.touched && registerForm.controls.name.errors?.['required']) {
                    <mat-error>Name is required</mat-error>
                    }
                    @if (registerForm.controls.name.touched && registerForm.controls.name.errors?.['maxlength']) {
                    <mat-error>Name cannot exceed 50 characters</mat-error>
                    }
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Email Address</mat-label>
                    <input matInput formControlName="email" type="email" placeholder="name@example.com" maxlength="100">
                    @if (registerForm.controls.email.touched && registerForm.controls.email.errors?.['required']) {
                    <mat-error>Email is required</mat-error>
                    }
                    @if (registerForm.controls.email.touched && registerForm.controls.email.errors?.['email']) {
                    <mat-error>Please enter a valid email</mat-error>
                    }
                    @if (registerForm.controls.email.touched && registerForm.controls.email.errors?.['maxlength']) {
                    <mat-error>Email cannot exceed 100 characters</mat-error>
                    }
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Password</mat-label>
                    <input matInput formControlName="password" type="password">
                    @if (registerForm.controls.password.touched && registerForm.controls.password.errors?.['required'])
                    {
                    <mat-error>Password is required</mat-error>
                    }
                    @if (registerForm.controls.password.touched && registerForm.controls.password.errors?.['minlength'])
                    {
                    <mat-error>Password must be at least 8 characters</mat-error>
                    }
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Confirm Password</mat-label>
                    <input matInput formControlName="confirmPassword" type="password">
                    @if ((registerForm.controls.confirmPassword.touched || registerForm.controls.confirmPassword.dirty)
                    && registerForm.errors?.['passwordMismatch']) {
                    <mat-error>Passwords do not match</mat-error>
                    }
                </mat-form-field>
            </div>

            <button mat-flat-button color="primary" type="submit" class="btn-primary"
                [disabled]="registerForm.invalid || store.isLoading()">
                @if (store.isLoading()) {
                <span>Registering...</span>
                } @else {
                Register Account
                }
            </button>
        </form>

        <p class="mt-6 text-center text-muted">
            Already have an account?
            <a routerLink="/login" class="success-link">Sign in</a>
        </p>
    </div>
</div>