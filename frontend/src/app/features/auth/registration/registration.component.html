<div class="centered-container">
    <div class="card">
        <div class="text-center">
            <h2 class="mt-6">Create Account</h2>
            <p class="mt-2 text-muted">Join us to start tracking your expenses</p>
        </div>

        @if (store.error()) {
        <div class="error-alert">
            @if (isArray(store.error())) {
            <ul class="mb-0">
                @for (err of asArray(store.error()); track $index) {
                <li>{{ err }}</li>
                }
            </ul>
            } @else {
            <p>{{ store.error() }}</p>
            }
        </div>
        }

        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="mt-8">
            <div class="mb-4">
                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Full Name</mat-label>
                    <input matInput formControlName="name" placeholder="John Doe">
                    @if (getControlErrorMessage('name')) {
                    <mat-error>{{ getControlErrorMessage('name') }}</mat-error>
                    }
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Email Address</mat-label>
                    <input matInput formControlName="email" type="email" placeholder="name@example.com">
                    @if (getControlErrorMessage('email')) {
                    <mat-error>{{ getControlErrorMessage('email') }}</mat-error>
                    }
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Password</mat-label>
                    <input matInput formControlName="password" type="password">
                    @if (getControlErrorMessage('password')) {
                    <mat-error>{{ getControlErrorMessage('password') }}</mat-error>
                    }
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Confirm Password</mat-label>
                    <input matInput formControlName="confirmPassword" type="password">
                    @if (getControlErrorMessage('confirmPassword')) {
                    <mat-error>{{ getControlErrorMessage('confirmPassword') }}</mat-error>
                    }
                </mat-form-field>

                @if (registerForm.controls.confirmPassword.touched && registerForm.errors?.['passwordMismatch']) {
                <div class="error-alert mt-2">
                    <p class="mb-0">Passwords do not match.</p>
                </div>
                }
            </div>

            <button mat-flat-button color="primary" type="submit" class="btn-primary" [disabled]="store.isLoading()">
                @if (store.isLoading()) {
                <span>Registering...</span>
                } @else {
                Register Account
                }
            </button>
        </form>

        <p class="mt-6 text-center text-muted">
            Already have an account?
            <a routerLink="/login" class="success-link">Sign in</a>
        </p>
    </div>
</div>